--1: What is the total revenue generated by Olist, and how has it changed over time?

select round(sum(i.price),2) as Total_revenue
from order_items_dataset i
join orders_dataset o on i.order_id=o.order_id
where o.order_status='delivered' ;


select round(sum(i.price),2) as Revenue_per_year,year(o.order_purchase_timestamp) as Year
from order_items_dataset i
join orders_dataset o on i.order_id=o.order_id
where o.order_status='delivered' 
group by year(o.order_purchase_timestamp) ;


--2: How many orders were placed on Olist, and how does this vary by month or season?

select count(order_id) as Order_count,month(order_purchase_timestamp) as Month,year(order_purchase_timestamp) as Year
from  dbo.orders_dataset 
group  by year(order_purchase_timestamp),month(order_purchase_timestamp)
order by year(order_purchase_timestamp),month(order_purchase_timestamp)  


--3: What are the most popular product categories on Olist, and how do their sales volumes
compare to each other?

select p.product_category_name,count(i.product_id) as Count_of_products_purchased
from dbo.products_dataset p
join order_items_dataset i on p.product_id=i.product_id
group by p.product_category_name
order by count(i.product_id) DESC



--4: What is the average order value (AOV) on Olist, and how does this vary by product category
or payment method?



select round(avg(p.payment_value),2) as AOV ,p.payment_type,pr.product_category_name
from order_items_dataset i
join dbo.order_payments_dataset p on i.order_id=p.order_id
join dbo.products_dataset pr on  i.product_id=pr.product_id 
group by p.payment_type,pr.product_category_name 
order by round(avg(p.payment_value),2) DESC


5: How many sellers are active on Olist, and how does this number change over time?

select count(s.seller_id) as sellers_active,year(o.shipping_limit_date) as year from dbo.sellers_dataset s
join dbo.order_items_dataset o on s.seller_id=o.seller_id
group by year(o.shipping_limit_date)
order by year(o.shipping_limit_date) 


6: What is the distribution of seller ratings on Olist, and how does this impact sales
performance
select  r.review_score as Rating,count(distinct s.seller_id) as Count_of_sellers
from order_items_dataset o
join dbo.order_reviews r on o.order_id=r.order_id
join sellers_dataset s on o.seller_id=s.seller_id
group by r.review_score
order by r.review_score  DESC
